<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: Components/CardProf/CardProf.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: Components/CardProf/CardProf.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import React, { Component } from 'react'

import defImage from '../../assets/images/redditor.png'
import axios from '../../axios-orders';
import './CardProf.css';
import { NavLink } from 'react-router-dom';

export class CardProf extends Component {

  constructor(props) {
    super(props);
    this.state = {
      username: '',
      subscriptions: [],
      cakeday: ''
    };
  }

    /**
     * Gets the current user name from the local storage
     * @function getCurrentUser
     */
  getCurrentUser() {
    return localStorage.getItem("Username");
  }

  // componentDidMount() {

  //   var headers = {
  //     'auth': localStorage.getItem("token")
  //   }

  //   let username = this.getCurrentUser();

  //   // axios.get('user/info/'+ username , { headers: headers })
  //   // .then(resp => {
  //   //   if (resp.status == 200) {
  //   //     console.log(resp);
  //   //     let myusername=this.state.username;
  //   //      let mysubscriptions = this.state.subscriptions;
  //   //      let mycakeday=this.state.cakeday;
  //   //      mycakeday.push(resp.data.cakeday);
  //   //      myusername.push(resp.data.Username);
  //   //      mysubscriptions.push(resp.data.Subscriptions);

  //   //     this.setState({
  //   //       username:myusername,
  //   //       cakeday:mycakeday
  //   //     });
  //   //   }
  //   //   })

  //   //     .catch(error => {
  //   //       console.log(error.response)
  //   //       alert("Error")
  //   //     });

  // };

    /**
     * Redirects to moderation page 
     * @function gotoMod
     */
  gotoMod() {
    window.location.href = "/moderation";
  }




  // createThread = (e) =>{
  //   e.preventDefault();
  //   this.setState({
  //     threadCreation:true
  //   })
  // }
  // handleSubmit = (e) => {
  //   e.preventDefault();
  //   let checker ="";

  //   let postTitle = document.getElementById("postTitle").value;
  //   let postBody = document.getElementById("postBody").value;
  //   if (postTitle===checker)
  //   {
  //     alert ("Please provide a Thread title!");
  //     return ;
  //   }
  //   else if (postBody===checker)
  //   { 
  //     alert ("Please provide a Thread Body !");
  //     return ;
  //   }
  //   var headers = {
  //     'auth':  localStorage.getItem('token')
  //   }
  //   let postName = this.state.name;
  //   axios.post('http://18.217.163.16/sr/'+postName+'/thread',postTitle,postBody,{headers: headers})
  //   .then(res => {
  //     console.log(res);
  //     if (res.status==200)
  //     { 
  //       alert("Post is created!");
  //     }else if (res.status===401 || res.status===404)
  //     {
  //       alert("Post not created");
  //       return Response.json;
  //     }
  //    })
  //    .catch(error => {
  //      alert("Error Caught");
  //    })
  // }

   /**
     * Handels user block 
     * @function handleBlock
     */
  handleBlock() {

    var headers = {
      'auth': localStorage.getItem("token")
    }
    var data = {
      blockeduser: this.state.username
    }

    axios.put('me/user/block/', data, { headers: headers }
    )
      .then(res => {
        console.log(res);
        if (res.status == 200) {
          alert("User is blocked!");
        } else if (res.status === 401 || res.status === 404) {
          alert(" Unsuccessful");
          return Response.json;
        }
      })
      .catch(error => {
        alert("Error Caught");
      })
  }

    /**
     * Handles adding a friend
     * @function handleFriend
     */
  handleFriend() {
    var headers = {
      'auth': localStorage.getItem("token")
    }
    let data = this.state.username
    let username =
      window.location.href.split("/")
        .pop()
        .replace("#post", "")
        .replace("#comment", "");
    axios.put('me/user/Add/', { fUsername: username }, { headers: headers }
    )

      .then(res => {
        console.log(res);
        if (res.status == 200) {
          this.setState({reqStatus: "sent"})
          alert("Friend Request Sent!");
        } else if (res.status === 401 || res.status === 404) {
          alert("Friend Request Sent Unsuccessful");
          return Response.json;
        }
      })
      .catch(error => {
        alert(error.response.data.error);
      })
  }
  componentDidMount(){
    // 

    var headers = {
      'auth': localStorage.getItem("token")
    }
    let username =
      window.location.href.split("/")
        .pop()
        .replace("#post", "")
        .replace("#comment", "");
      axios.put('me/user/Add/', { fUsername: username }, { headers: headers }
      )
  
        .then(res => {
          console.log(res);
          if (res.status == 200) {
            axios.put("me/user/removeReq", {fUsername: username}, {headers: headers})
            .then(resp => {
              console.log(resp.data);
            })
            // this.setState({req})
          } else if (res.status === 401 || res.status === 404) {
            alert("Friend Request Sent Unsuccessful");
            return Response.json;
          }
        })
        .catch(error => {
          if(error.response.data.error === "User has already sent a request to the other user"){
            this.setState({reqStatus: "sent"})
          }else if(error.response.data.error === "The User to be added is already a friend"){
            this.setState({reqStatus: "friend"})
          }else if(error.response.data.error === "The sending User is blocked"){
            this.setState({reqStatus: "blocked"})
          }
        })
  }
  /**
     * Handels user unblock 
     * @function handleUnblock
     */
  handleUnblock(){
    var headers = {
      'auth': localStorage.getItem("token")
    }
    let data = this.state.username
    let username =
      window.location.href.split("/")
        .pop()
        .replace("#post", "")
        .replace("#comment", "");
    axios.put('me/user/unblock/', { unblockedUser: username }, { headers: headers }
    )

      .then(res => {
        console.log(res);
        if (res.status == 200) {
          this.setState({reqStatus: null})
        } else if (res.status === 401 || res.status === 404) {
          alert("Can't process your request right now");
        }
      })
      .catch(error => {
          alert("Can't process your request right now");
      })
  }

     /**
     * 
     * @function removeReq
     */
  removeReq(){

    var headers = {
      'auth': localStorage.getItem("token")
    }
    let data = this.state.username
    let username =
      window.location.href.split("/")
        .pop()
        .replace("#post", "")
        .replace("#comment", "");
    axios.put('/me/user/removeReq', { fUsername: username }, { headers: headers }
    )

      .then(res => {
        if (res.status == 200) {
          this.setState({reqStatus: null})
        } else if (res.status === 401 || res.status === 404) {
          alert("Can't process your request right now");
        }
      })
      .catch(error => {
          alert("Can't process your request right now");
      })
  }
    /**
     * Handels user unfriend 
     * @function Unfriend
     */
  Unfriend(){

    var headers = {
      'auth': localStorage.getItem("token")
    }
    let data = this.state.username
    let username =
      window.location.href.split("/")
        .pop()
        .replace("#post", "")
        .replace("#comment", "");
    axios.put('/me/user/Unfriend', { fUsername: username }, { headers: headers }
    )

      .then(res => {
        if (res.status == 200) {
          this.setState({reqStatus: null})
        } else if (res.status === 401 || res.status === 404) {
          alert("Can't process your request right now");
        }
      })
      .catch(error => {
          alert("Can't process your request right now");
      })
  }
  render() {
    return (

      &lt;div className='gamb'>
        &lt;div className="userImage" style={{ backgroundImage: `url(${defImage})` }}>
        &lt;/div>
        &lt;br />
        &lt;div>{this.props.q}&lt;/div>
        &lt;h5>Cake Day: {this.props.cake}&lt;/h5>

        &lt;button type="button" id="addFriend" class="btn btn-primary" onClick={
          this.state.reqStatus === "sent" ? this.removeReq.bind(this) :
          this.state.reqStatus === "friend" ? this.Unfriend.bind(this) :
          this.state.reqStatus === "blocked" ? this.handleUnblock.bind(this) :
          !this.state.reqStatus ? this.handleFriend.bind(this) : null
        }>
          {this.state.reqStatus === "sent" ? "Remove Request" : null}
          {this.state.reqStatus === "friend" ? "Unfriend" : null}
          {this.state.reqStatus === "blocked" ? "Unblock" : null}
          {!this.state.reqStatus ? "Add Friend" : null}
        &lt;/button>
        {this.state.reqStatus === "friend" || !this.state.reqStatus ? 
        &lt;input class="btn btn-primary" type="submit" id="blockfriend" value="Block friend" onClick={this.handleBlock.bind(this)} />
        : null
        }

        {/* &lt;button  onClick={this.createThread} className='new-post-button'>New post&lt;/button> */}


        {/* this.state.threadCreation ?
              &lt;div className="subredditSidebarComponent">
                {/* &lt;h5>CREATE A POST&lt;/h5> */}

        {/* &lt;form onSubmit={this.handleSubmit}>
                  &lt;div className="formGroupSrComponent">
                  &lt;label for="ThreadTitle">Enter Title&lt;/label>
                  &lt;textarea type="textarea" name="text" id="postTitle" placeholder = "Enter Title Here" />   
                  &lt;/div>
                  &lt;div className="formGroupSrComponent">
                  &lt;label for="ThreadBody">Enter Body&lt;/label>
                  &lt;textarea type="textarea" name="text" id="postBody" placeholder = "Enter Body Here" />  
                  &lt;/div>
                  &lt;button className="srSidebarSubscribeButton">CREATE&lt;/button>
                &lt;/form> */}
        &lt;div>&lt;/div>

      &lt;/div>

    )
  }
}


export default CardProf
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#_handleInputChange">_handleInputChange</a></li><li><a href="global.html#_handleOnSubmit">_handleOnSubmit</a></li><li><a href="global.html#BanUser">BanUser</a></li><li><a href="global.html#blockList">blockList</a></li><li><a href="global.html#BlockUser">BlockUser</a></li><li><a href="global.html#CancelCreation">CancelCreation</a></li><li><a href="global.html#cancelEdit">cancelEdit</a></li><li><a href="global.html#cancelSubreddit">cancelSubreddit</a></li><li><a href="global.html#cardViewHandler">cardViewHandler</a></li><li><a href="global.html#checkforpostorcomment">checkforpostorcomment</a></li><li><a href="global.html#checkValidity">checkValidity</a></li><li><a href="global.html#classicViewHandler">classicViewHandler</a></li><li><a href="global.html#closeBlockList">closeBlockList</a></li><li><a href="global.html#closeLogin">closeLogin</a></li><li><a href="global.html#closeRegistration">closeRegistration</a></li><li><a href="global.html#CreateFlair">CreateFlair</a></li><li><a href="global.html#createThread">createThread</a></li><li><a href="global.html#createThreads">createThreads</a></li><li><a href="global.html#createThreadSidebar">createThreadSidebar</a></li><li><a href="global.html#DeleteReport">DeleteReport</a></li><li><a href="global.html#DeleteReportedComment">DeleteReportedComment</a></li><li><a href="global.html#DeleteReportedPost">DeleteReportedPost</a></li><li><a href="global.html#delPost">delPost</a></li><li><a href="global.html#editPost">editPost</a></li><li><a href="global.html#editSubreddit">editSubreddit</a></li><li><a href="global.html#filterList">filterList</a></li><li><a href="global.html#getBlockList">getBlockList</a></li><li><a href="global.html#getCurrentUser">getCurrentUser</a></li><li><a href="global.html#getFlairs">getFlairs</a></li><li><a href="global.html#getListing">getListing</a></li><li><a href="global.html#getMsgs">getMsgs</a></li><li><a href="global.html#getNotif">getNotif</a></li><li><a href="global.html#getReports">getReports</a></li><li><a href="global.html#getThreads">getThreads</a></li><li><a href="global.html#goTo">goTo</a></li><li><a href="global.html#goToCreatePost">goToCreatePost</a></li><li><a href="global.html#goToCreateSr">goToCreateSr</a></li><li><a href="global.html#gotoMod">gotoMod</a></li><li><a href="global.html#handleAboutChange">handleAboutChange</a></li><li><a href="global.html#handleBlock">handleBlock</a></li><li><a href="global.html#handleChange">handleChange</a></li><li><a href="global.html#handleClick">handleClick</a></li><li><a href="global.html#handledecrement">handledecrement</a></li><li><a href="global.html#handleEdit">handleEdit</a></li><li><a href="global.html#handleFileChange">handleFileChange</a></li><li><a href="global.html#handleFriend">handleFriend</a></li><li><a href="global.html#handleIncrement">handleIncrement</a></li><li><a href="global.html#handleLoginContainerClick">handleLoginContainerClick</a></li><li><a href="global.html#handleNewImage">handleNewImage</a></li><li><a href="global.html#handleNewPasswordChange">handleNewPasswordChange</a></li><li><a href="global.html#handleRegContainerClick">handleRegContainerClick</a></li><li><a href="global.html#handleSubmit">handleSubmit</a></li><li><a href="global.html#handleUnblock">handleUnblock</a></li><li><a href="global.html#leavemoderation">leavemoderation</a></li><li><a href="global.html#logout">logout</a></li><li><a href="global.html#MarkRead">MarkRead</a></li><li><a href="global.html#MarkReadAll">MarkReadAll</a></li><li><a href="global.html#MarkUnRead">MarkUnRead</a></li><li><a href="global.html#MarkUnReadAll">MarkUnReadAll</a></li><li><a href="global.html#onChange">onChange</a></li><li><a href="global.html#onChangeSr">onChangeSr</a></li><li><a href="global.html#onChangeUser">onChangeUser</a></li><li><a href="global.html#onSave">onSave</a></li><li><a href="global.html#openLogInDialogue">openLogInDialogue</a></li><li><a href="global.html#openRegDialogue">openRegDialogue</a></li><li><a href="global.html#removeReq">removeReq</a></li><li><a href="global.html#reply">reply</a></li><li><a href="global.html#setSR">setSR</a></li><li><a href="global.html#sortHandHot">sortHandHot</a></li><li><a href="global.html#sortHandNew">sortHandNew</a></li><li><a href="global.html#sortHandTop">sortHandTop</a></li><li><a href="global.html#srSubscribe">srSubscribe</a></li><li><a href="global.html#srUnSubscribe">srUnSubscribe</a></li><li><a href="global.html#unBlockUser">unBlockUser</a></li><li><a href="global.html#Unfriend">Unfriend</a></li><li><a href="global.html#userHasLoggedIn">userHasLoggedIn</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.5.5</a> on Tue May 07 2019 22:19:47 GMT+0200 (Eastern European Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
